package dns

import kotlin.test.Test
import kotlin.test.Ignore

import kotlin.test.assertEquals
import org.mockito.Mockito


class ResolverTest {

  fun hexToByteArray(hexString: String): ByteArray = hexString.chunked(2).map({ it.toInt(16).toByte() }).toByteArray()


  @Test @Ignore
  fun `test resolve`() {
    val mockUdpClient = Mockito.mock(UdpInterface::class.java)
    val dnsPacket = hexToByteArray("e4bf8180000100010000000003777777076578616d706c6503636f6d0000010001c00c0001000100004ec400045db8d822000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000")
    Mockito.`when`(mockUdpClient.sendQuery(Mockito.anyString(), Mockito.any(ByteArray::class.java))).thenReturn(dnsPacket)
    val resolver = Resolver(TimedCache() ,mockUdpClient)
    val ip = resolver.resolve("www.example.com", TYPE_A)
    assertEquals("93.184.216.34", ip)
  }

}